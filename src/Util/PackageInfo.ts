import { HttpService, RunService } from '@rbxts/services'
import { ipcClient, ipcServer } from './IPC'

const PackgeURL = 'https://raw.githubusercontent.com/Calpico-Drink/AntiExploit/main/package.json'

interface PackageTypes {
	name: string
	version: string
	main: string
	author: string
	license: string
}

let PackageData: PackageTypes

if (RunService.IsServer()) {
	PackageData = HttpService.JSONDecode<PackageTypes>(HttpService.GetAsync(PackgeURL))
	ipcServer.on('get-packageinfo', (Player) => {
		ipcServer.emit('return-packageinfo', Player, PackageData)
	})
} else {
	ipcClient.on('return-packageinfo', (Info) => {
		PackageData = Info as PackageTypes
	})
	ipcClient.emit('get-packageinfo')
}

export { PackageData }
